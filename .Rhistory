y="Nº of ratings")
age_pro <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso"),
value = profiles['agegroup'] %>% count(agegroup))
#libraries
library(dplyr)
library(ggplot2)
library(gridExtra)
profiles$gender <- as.factor(profiles$gender)
summary(profiles)
profiles['agegroup'] <- profiles['age'] %>% mutate(age =
ifelse(is.na(age) , "Desconhecido",
ifelse(age >= 10 & age < 18, 'Adolescente',
ifelse(age >= 18 & age < 35, 'Jovem Adulto',
ifelse(age >= 35 & age < 65, 'Adulto',
ifelse(age >= 65 & age <= 90, 'Idoso',
"Desconhecido"))))))
age_raw <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Jovem Adulto", "Idoso"),
value = profiles['agegroup'] %>% count(agegroup))
age_raw_plot = ggplot(age_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff","#6600ff")) +
labs(title="Figura 2: Utilizadores por faixa etária",
x="Sexo", y="Nº de Utilizadores")
# Create data
gender_raw <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"),
value = profiles['gender'] %>% count(gender))
gender_raw_plot = ggplot(gender_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
# Create data
ratings['rating'] = floor(ratings$rating)
ratings_raw <- data.frame(
name = c(0,1,2,3,4,5), value = ratings %>% count(rating)
)
# Barplot
ratings_raw_plot <- ggplot(ratings_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c( "#fefe01", "#bffe01", "#80fe01","#fefe01", "#bffe01", "#80fe01")) +
theme(legend.position="none") +
labs(
title="Figura 1: Classificações de filmes",
x="Rating",
y="Nº of ratings")
age_pro <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso"),
value = profiles['agegroup'] %>% count(agegroup))
#libraries
library(dplyr)
library(ggplot2)
library(gridExtra)
profiles$gender <- as.factor(profiles$gender)
summary(profiles)
profiles['agegroup'] <- profiles['age'] %>% mutate(age =
ifelse(is.na(age) , "Desconhecido",
ifelse(age >= 10 & age < 18, 'Adolescente',
ifelse(age >= 18 & age < 35, 'Jovem Adulto',
ifelse(age >= 35 & age < 65, 'Adulto',
ifelse(age >= 65 & age <= 90, 'Idoso',
"Desconhecido"))))))
age_raw <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso", "Jovem Adulto"),
value = profiles['agegroup'] %>% count(agegroup))
age_raw_plot = ggplot(age_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff","#6600ff")) +
labs(title="Figura 2: Utilizadores por faixa etária",
x="Sexo", y="Nº de Utilizadores")
# Create data
gender_raw <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"),
value = profiles['gender'] %>% count(gender))
gender_raw_plot = ggplot(gender_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
# Create data
ratings['rating'] = floor(ratings$rating)
ratings_raw <- data.frame(
name = c(0,1,2,3,4,5), value = ratings %>% count(rating)
)
# Barplot
ratings_raw_plot <- ggplot(ratings_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c( "#fefe01", "#bffe01", "#80fe01","#fefe01", "#bffe01", "#80fe01")) +
theme(legend.position="none") +
labs(
title="Figura 1: Classificações de filmes",
x="Rating",
y="Nº of ratings")
age_pro <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso", "Jovem Adulto"),
value = profiles['agegroup'] %>% count(agegroup))
age_pro_plot = ggplot(age_pro, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff", "#6600ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
grid.arrange(age_raw_plot, age_pro_plot, ncol=2)
#libraries
library(dplyr)
library(ggplot2)
library(gridExtra)
#libraries
library(dplyr)
library(ggplot2)
library(gridExtra)
profiles$gender <- as.factor(profiles$gender)
summary(profiles)
profiles['agegroup'] <- profiles['age'] %>% mutate(age =
ifelse(is.na(age) , "Desconhecido",
ifelse(age >= 10 & age < 18, 'Adolescente',
ifelse(age >= 18 & age < 35, 'Jovem Adulto',
ifelse(age >= 35 & age < 65, 'Adulto',
ifelse(age >= 65 & age <= 90, 'Idoso',
"Desconhecido"))))))
age_raw <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso", "Jovem Adulto"),
value = profiles['agegroup'] %>% count(agegroup))
age_raw_plot = ggplot(age_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff","#6600ff")) +
labs(title="Figura 2: Utilizadores por faixa etária",
x="Sexo", y="Nº de Utilizadores")
# Create data
gender_raw <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"),
value = profiles['gender'] %>% count(gender))
gender_raw_plot = ggplot(gender_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
# Create data
ratings['rating'] = floor(ratings$rating)
ratings_raw <- data.frame(
name = c(0,1,2,3,4,5), value = ratings %>% count(rating)
)
# Barplot
ratings_raw_plot <- ggplot(ratings_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c( "#fefe01", "#bffe01", "#80fe01","#fefe01", "#bffe01", "#80fe01")) +
theme(legend.position="none") +
labs(
title="Figura 1: Classificações de filmes",
x="Rating",
y="Nº of ratings")
age_pro <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso", "Jovem Adulto"),
value = profiles['agegroup'] %>% count(agegroup))
age_pro_plot = ggplot(age_pro, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff", "#6600ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
grid.arrange(age_raw_plot, age_pro_plot, ncol=2)
#libraries
library(dplyr)
library(ggplot2)
library(gridExtra)
movies <- read.csv('data/movies.csv')
profiles <- read.csv('data/profiles.csv')
ratings <- read.csv('data/ratings.csv')
profiles$gender <- as.factor(profiles$gender)
summary(profiles)
profiles['agegroup'] <- profiles['age'] %>% mutate(age =
ifelse(is.na(age) , "Desconhecido",
ifelse(age >= 10 & age < 18, 'Adolescente',
ifelse(age >= 18 & age < 35, 'Jovem Adulto',
ifelse(age >= 35 & age < 65, 'Adulto',
ifelse(age >= 65 & age <= 90, 'Idoso',
"Desconhecido"))))))
age_raw <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso", "Jovem Adulto"),
value = profiles['agegroup'] %>% count(agegroup))
age_raw_plot = ggplot(age_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff","#6600ff")) +
labs(title="Figura 2: Utilizadores por faixa etária",
x="Sexo", y="Nº de Utilizadores")
# Create data
gender_raw <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"),
value = profiles['gender'] %>% count(gender))
gender_raw_plot = ggplot(gender_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
summary(ratings)
# Create data
ratings['rating'] = floor(ratings$rating)
ratings_raw <- data.frame(
name = c(0,1,2,3,4,5), value = ratings %>% count(rating)
)
# Barplot
ratings_raw_plot <- ggplot(ratings_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c( "#fefe01", "#bffe01", "#80fe01","#fefe01", "#bffe01", "#80fe01")) +
theme(legend.position="none") +
labs(
title="Figura 1: Classificações de filmes",
x="Rating",
y="Nº of ratings")
# Preliminary Analisys
print(paste("Existem ",
length(movies$movieid),
"filmes no dataset",
sep=" "))
print(paste("Existem",
length(unique(ratings$movieid)),
"filmes com classifição",
sep=" "))
print(paste("Portanto podemos retirar",
length(movies$movieid) - length(unique(ratings$movieid)),
sep=" "))
relevant <- unique(ratings$movieid)
movies <- movies[match(movies$movieid, relevant, nomatch=0),]
ratings <- filter(ratings, rating >= 3)
positive <- ratings %>% count(movieid)
summary(positive)
positive <- filter(positive, n >= 50)
ratings <- filter(ratings, movieid %in% positive$movieid)
movies <- filter(movies, movieid %in% positive$movieid)
# Create data
ratings_pro <- data.frame(
name = c(3,4,5), value = ratings %>% count(rating)
)
# Barplot
ratings_pro_plot <- ggplot(ratings_pro, aes(x=factor(name), y=value.n)) +
geom_bar(stat = "identity" ,
fill = c( "#fefe01", "#bffe01", "#80fe01")) +
theme(legend.position="none") +
labs(
title="Figura 1: Ratings de filmes com mais de 10 ratings \"positivos\"",
x="Rating",
y="Nº of ratings")
users_prof <- unique(profiles$userid)
c_users_prof <- length(users_prof)
# Number of total users
print(c_users_prof)
users_rat <- unique(ratings$userid)
c_users_rat <- length(users_rat)
# Number of users that have rated a movie
print(c_users_rat)
# Number of useless users
print(c_users_prof - c_users_rat)
profiles <- filter(profiles, userid %in% users_rat)
# Create data
gender_pro <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"), value = profiles['gender'] %>% count(gender)
)
# Barplot
gender_pro_plot = ggplot(gender_pro, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores que já classificaram um filme por género",
x="Sexo", y="Nº de Utilizadores")
grid.arrange(gender_raw_plot, gender_pro_plot, ncol=2)
# Create data
gender_pro <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"), value = profiles['gender'] %>% count(gender)
)
# Barplot
gender_pro_plot = ggplot(gender_pro, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores que já classificaram um filme por género",
x="Sexo", y="Nº de Utilizadores")
grid.arrange(gender_raw_plot, gender_pro_plot, ncol=2)
age_pro <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso", "Jovem Adulto"),
value = profiles['agegroup'] %>% count(agegroup))
age_pro_plot = ggplot(age_pro, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff", "#6600ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
grid.arrange(age_raw_plot, age_pro_plot, ncol=2)
# Create data
gender_pro <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"), value = profiles['gender'] %>% count(gender)
)
# Barplot
gender_pro_plot = ggplot(gender_pro, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores que já classificaram um filme por género",
x="Sexo", y="Nº de Utilizadores")
grid.arrange(gender_raw_plot, gender_pro_plot, ncol=2)
gender_pro <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"), value = profiles['gender'] %>% count(gender))
gender_pro_plot = ggplot(gender_pro, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores que já classificaram um filme por género",
x="Sexo", y="Nº de Utilizadores")
grid.arrange(gender_raw_plot, gender_pro_plot, ncol=2)
grid.arrange(gender_raw_plot, gender_pro_plot, ncol=2)
ggplot(age_pro, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
ggplot(age_pro, aes(age)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
ggplot(age_pro, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
age_pro
ggplot(age_pro, aes(names)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
ggplot(profile, aes(age)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
ggplot(profiles, aes(age)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
age_pro
profiles
ggplot(profile, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
age_pro
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
age_pro
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(-sex)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(-gender)
profiles.columns
head(profiles)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)) + fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff", "#6600ff")))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)) , fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff", "#6600ff")))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff", "#6600ff"))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = c("#33cc33"))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = fatcor(..x..))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = factor(..x..))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = as.factor(..x..))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = factor(x))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = factor(agegroup))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..)), fill = factor(profiles$agegroup))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(profiles$agegroup)))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)), stat='count')  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)), stat='count')  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)), stat='count')  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat='count')  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = ..prop.., fill = factor(..agegroup..)), stat='count')  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat='count')  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(..x..)), stat='count')  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  + geom_text(aes( label = scales::percent(..prop..),
y= ..prop.. ), stat= "count", vjust = -.5) +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  +
scale_y_continuous(labels=scales::percent) + labs(y = 'Percent', fill='agegroup')
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  +
scale_y_continuous(labels=scales::percent) + labs(y = 'Percent', fill='agegroup') +
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  +
scale_y_continuous(labels=scales::percent)
ylab("relative frequencies") + facet_grid(~gender)
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
movies <- read.csv('data/movies.csv')
profiles <- read.csv('data/profiles.csv')
#ratings <- read.csv('data/ratings.csv')
profiles$gender <- as.factor(profiles$gender)
summary(profiles)
profiles['agegroup'] <- profiles['age'] %>% mutate(age =
ifelse(is.na(age) , "Desconhecido",
ifelse(age >= 10 & age < 18, 'Adolescente',
ifelse(age >= 18 & age < 35, 'Jovem Adulto',
ifelse(age >= 35 & age < 65, 'Adulto',
ifelse(age >= 65 & age <= 90, 'Idoso',
"Desconhecido"))))))
age_raw <- data.frame(
name = c("Adolescente","Adulto", "Desconhecido", "Idoso", "Jovem Adulto"),
value = profiles['agegroup'] %>% count(agegroup))
age_raw_plot = ggplot(age_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#33cc33", "#3399ff","#4d4d4d", "#6600ff","#6600ff")) +
labs(title="Figura 2: Utilizadores por faixa etária",
x="Sexo", y="Nº de Utilizadores")
# Create data
gender_raw <- data.frame(
name = c("Desconhecido","Feminino", "Masculino"),
value = profiles['gender'] %>% count(gender))
gender_raw_plot = ggplot(gender_raw, aes(x=name, y=value.n)) +
geom_bar(stat = "identity" ,
fill = c("#4d4d4d", "#ff1ac6", "#0066ff")) +
labs(title="Figura 2: Utilizadores por género",
x="Sexo", y="Nº de Utilizadores")
ggplot(profiles, aes(agegroup)) +
geom_bar(aes(y = (..count..)/sum(..count..), fill = factor(agegroup)))  +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") + facet_grid(~gender)
